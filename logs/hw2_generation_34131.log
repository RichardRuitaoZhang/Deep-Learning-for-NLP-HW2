/var/spool/slurmd/job34131/slurm_script: line 17: conda: command not found
Starting generative fine-tuning on GPU...
Thu Nov  6 17:31:42 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.86.15              Driver Version: 570.86.15      CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A100 80GB PCIe          On  |   00000000:CA:00.0 Off |                    0 |
| N/A   24C    P0             42W /  300W |       1MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
loading pretrained weights...
Traceback (most recent call last):
  File "/gpfs/projects/b1080/rz/cs461/HW2/generation.py", line 170, in <module>
    main()
  File "/gpfs/projects/b1080/rz/cs461/HW2/generation.py", line 159, in main
    acc = evaluate(model, val_loader, tokenizer, opt.device)
  File "/home/mnr4714/miniconda3/envs/transformer/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
  File "/gpfs/projects/b1080/rz/cs461/HW2/generation.py", line 94, in evaluate
    choice_logits = last_logits[:, id_list]      # (1, 4)
NameError: name 'id_list' is not defined
Fine-tuning completed. Model saved to models/qa_finetuned.pt
